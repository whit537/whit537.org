title = "Fun with screen-scraping"
published = "2007-01-08T16:22:00.000-05:00"
updated = "2011-04-10T09:52:45.368-04:00"
^L
^L
{% extends "base.html" %}
{% block content %}
Today for a client I had to grab last year's newsletters from <a href="http://www.intellicontact.com/">Intellicontact</a> and post them as static HTML files. The specific mailings to archive were given to me as row numbers on an Intellicontact list view, so the first thing to do was translate those row numbers to Intellicontact message IDs.  <a href="http://www.crummy.com/software/BeautifulSoup/">BeautifulSoup</a> to the rescue! I manually saved the listing page (actually there were two), and then used <a href="http://www.whit537.org/tech/2007/extract.py">this basic recipe</a> to generate a CSV with message IDs and post dates.<br /><br />The next step was to download the edit view for each message, and extract the newsletter content from it. I started with <a href="http://docs.python.org/lib/module-urllib.html">urllib</a>, but I needed cookies to stay authenticated at Intellicontact. So then I tried <a href="http://twill.idyll.org/">twill</a>. It looked promising at first, but I ended up getting <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.7">a <span style="font-family:courier new;">406 Not Accepted</span> response</a> from the edit page. Maybe this was because twill doesn't support JavaScript? Third try was the charm: <a href="http://www.openqa.org/pywinauto/">pywinauto</a>! The distribution includes an example script for saving a web page with Firefox, and that's what I used as my starting point for <a href="http://static.whit537.org/2007/get-newsletters.py">this script</a>.<br /><br />This was my first time with twill as well as pywinauto. Both look like useful tools. I also learned from the BeautifulSoup docs about <a href="http://dalchemy.com/opensource/unicodedoc/">a practical Unicode how-to</a> that I'm looking forward to reading (I still don't have <a href="http://www.joelonsoftware.com/articles/Unicode.html">that zen</a>). And after all the recent work on <a href="http://www.zetadev.com/software/aspen/">Aspen</a> and <a href="http://tech.whit537.org/2007/01/dewey-think-google-desktop-for-python.html">Dewey</a>--where the tests pass and the APIs are clean--I was reminded today that what people  pay you for is to get dirty!<div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/36506138-3409662809636690475?l=blag.whit537.org' alt='' /></div>
{% end %}
