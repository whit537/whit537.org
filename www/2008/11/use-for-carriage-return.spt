title = "A use for the carriage return"
published = "2008-11-24T14:16:00.006-05:00"
updated = "2011-04-10T09:52:45.044-04:00"
[---]
[---] text/html
{% extends "base.html" %}
{% block content %}
<p>I just found out what the carriage return character, \r, is good for. A friend was asking for help on a command-line program: he wanted to update a progress indicator. This is like you get when downloading something with <code>curl</code> or <code>wget</code> or <code>fetch</code>. So I opened up /usr/src/usr.bin/fetch/fetch.c, expecting to find some low-level TTY hackery. Instead, I found this key line:</p><pre>fprintf(stderr, "\r%-46.46s", xs->name);<br /></pre><p>It turns out that the carriage return moves the output cursor back to the beginning of the current line, so further output overwrites whatever was already there. It turns out, too, that this works from Python on both Unix and Windows:<br /></p><pre>>>> print "foo\rbar"<br />bar<br /></pre><p>Yay!</p><p>This makes sense if you think about where the term "carriage return" comes from, and it also makes sense out of why Windows includes it as part of its EOL indicator.I have a typewriter at home, and I've been using it lately to type invoices for the little bit of consulting that I still do. The bar on my typewriter that ends a line actually <i>does</i> perform two functions: first it scrolls the paper up&mdash;newline, \n. Then if you keep pushing the bar, it moves the carriage (the roller assembly that holds the paper) back to the right until you hit your first tab stop&mdash;carriage return, \r. So on my typewriter the EOL sequence is \n\r, but apparently on <a href="http://www.oualline.com/eol.html">teletypes the order was reversed</a>. And I actually do perform a \n without a \r sometimes, like when I'm lining up columns on an invoice. I can do a \r without a \n too, but that's a different knob.</p><p>Unlike so many Unix conventions that are the result of ossified traditions from more innocent times, it appears that the single-character EOL is actually an innovation. It's fun to know your roots.</p><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/36506138-3590371759556102549?l=blag.whit537.org' alt='' /></div>
{% endblock %}