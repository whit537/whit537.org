<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>"Return" by Chad Whitacre</title>
        <style>
            BODY {
                margin: 0;
                padding: 0;
                font: normal 12pt/14pt Georgia, serif;
                background: #E6DBB5;
            }


            H2 {
                font: normal 18pt/22pt Arial, sans-serif;
                margin: 2em 0 0.5em;
                padding: 0;
            }
            H2.first {
                margin-top: 0;
            }
            OBJECT {
                margin: 2em 0 0;
                padding: 0;
            }
            OL LI {
                padding-bottom: 1em;
            }
            P {
                margin: 0;
                padding: 0;
                text-indent: 2em;
                text-align: justify;
            }

            #whit537 {
                font: bold 32px/32px Arial, sans-serif;
                background: #C8DEFE;
                width: 100%;
            } 
            #whit537 .padding {
                padding: 40px;
            }
            #whit537 SPAN {
                display: block;
                position: absolute;
                top: 80px;
                left: 40px;
                font: normal 8.5pt/11pt Verdana, serif;
                text-transform: uppercase;
            }


            #statement {
                position: absolute;
                top: 144px;
                left: 40px;
                width: 400px;
                z-index: 0;
            }
            #statement TABLE {
                border-spacing: 0;
                border-collapse: collapse;
                margin: 2em 0 1em 2em;
                padding: 0;
            }
            #statement TD {
                font: normal 10pt/12pt Verdana, sans-serif;
                vertical-align: top;
                padding: 0 1em 1em 0;
            }
            #statement TD A {
                font-weight: bold;
            }
            #statement TD SPAN.format {
                display: block;
                color: #666;
                text-indent: -2em;
                padding-left: 2em;
            }


            #stream {
                position: fixed;
                top: 144px;
                left: 480px;
                width: 4000px;
                height: 4000px;
                background: white;
                z-index: 0;
            }
            #stream TABLE {
                border-spacing: 0;
                border-collapse: collapse;
                margin: 0;
                padding: 0;
                width: 3000px;
                background: white;
            }
            #stream TABLE#knobs {
                border-top: 1px solid yellow;
            }
            #stream TD {
                vertical-align: top;
                padding: 0.25em;
            }
            #stream TD DIV#entering, 
            #stream TD DIV#voting {
                display: none;
            }
            #stream TD DIV#voting {
                color: green;
                font: bold 10pt/12pt Verdana, sans-serif;
            }


            .query {
                white-space: nowrap; 
            }
            .query SPAN.age {
                display: block;
                color: #999;
                font: normal 9px/11px Verdana, sans-serif;
            }


            .future {
                border-left: 7px solid yellow;
            }
            .future SPAN.upvote {
                color: #00E;
                text-decoration: underline;
                cursor: pointer;
            }
            .present {
                border-left: 7px solid red;
                background: #FFDBDB;
            }
            .present TD SPAN {
                color: black;
            }
            .past {
                border-left: 7px solid blue;
                color: #999;
            }
            .past TD SPAN.age {
                color: #CCC;
            }


            FORM {
                display: inline;
            }
            #q {
                width: 20em;
            }
            #knobs DIV { /* nchars */
                display: block;
                font: normal 9px/11px Verdana, sans-serif;
                color: #999;
            }
            #nchars.too-long {
                color: red;
                font-weight: bold;
            }
            .error {
                margin: 0;
                padding: 0;
                color: red;
                font: bold 10pt/12pt Verdana, sans-serif;
            }
            .ext {
                background: #999;
            }
            .votes {
                font: bold 18pt/20pt Arial, sans-serif;
                text-align: right;
                width: 2em;
            }
        </style>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
        <script>
            function loadStream(q) {
                Q = $('#q');
                q = (undefined == q) ? Q.attr('value') : q;
                $('#stream #load').load(
                    'stream.html',
                    {'q':q},
                    function () {

                        // Set Knobs
                        // =========

                        if ($('.entry').length == 10)
                        {
                            $('#entering').hide();
                            $('#voting').show();
                            $('#voting').load('voting.txt');
                            $('.entry').addClass('upvote');
                        }
                        else
                        {
                            $('#entering').show(function () {
                                Q.attr('value', '');
                                Q.focus();
                            });
                            $('#voting').hide();
                            $('.entry').removeClass('upvote');
                        }

                    }
                ); 
            }

            $('document').ready(function () {

                loadStream('');

                // Wire up the entry form.
                $('FORM').submit(function (e) {
                    loadStream();
                    return false;
                });

                // Wire up the refresh button.
                $('input[value=Refresh]').click(function () {
                    loadStream('');
                });

                // Wire up click-to-vote.
                $('#stream #load SPAN.upvote').live('click', function (e) {
                    q = $(e.target).html();
                    loadStream(q);
                    return false;
                });

                // Wire up the character counter.
                $('#q').keyup(function (e) {
                    val = $('#q').attr('value');
                    $('#nchars').html(val.length);

                    if (val.length > 40)
                        $('#nchars').addClass("too-long");
                    else
                        $('#nchars').removeClass("too-long");

                    if (1 == val.length)
                        $('#nchars-plural').html('');
                    else 
                        $('#nchars-plural').html('s');
                });

            });
        </script>
    </head>
    <body>
        <div id="whit537"><div class="padding">

            <a href="/return/"><i>Return</i></a>, 
            by <a href="/">Chad Whitacre</a>

            <span>December 7, 2009 <i>through</i> January 8, 2010</span>

        </div></div>

        <div id="statement">

            <h2 class="first">Rules</h2>

            <ol>

                <li>Say something awesome/clever/interesting in 40 characters
                or less.</li>

                <li>Voting starts once there are ten entries. Click to vote
                entries up.</li>

                <li>If it takes 15 minutes to get ten entries, voting stays open
                for 15 minutes.<br /><br />
                If it takes two days, voting is open for two days.<br /><br />
                Etc.</li>

                <li>When voting is over, the winning entry goes on a screen in
                my hallway, and the game starts over.</li>
 
            </ol>

            <object width="400" height="300">
                <param name="flashvars" value="offsite=true&lang=en-us&page_show_url=%2Fphotos%2Fwhit537%2Fsets%2F72157622831444845%2Fshow%2F&page_show_back_url=%2Fphotos%2Fwhit537%2Fsets%2F72157622831444845%2F&set_id=72157622831444845&jump_to="></param>
                <param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=71649"></param>
                <param name="allowFullScreen" value="true"></param>
                <embed type="application/x-shockwave-flash" src="http://www.flickr.com/apps/slideshow/show.swf?v=71649" allowFullScreen="true" flashvars="offsite=true&lang=en-us&page_show_url=%2Fphotos%2Fwhit537%2Fsets%2F72157622831444845%2Fshow%2F&page_show_back_url=%2Fphotos%2Fwhit537%2Fsets%2F72157622831444845%2F&set_id=72157622831444845&jump_to=" width="400" height="300"></embed>
            </object>            


            <h2>Statement</h2>
            
            <p>On a desk in our upstairs hall, right outside my office, a
            15&rdquo; LCD monitor sits atop an Olympia manual typewriter. The
            screen shows the Google homepage. Periodically, a new
            query&mdash;seemingly from nowhere&mdash;is automatically entered
            into the search box. All that remains is to hit <i>return</i>.</p>

            <p>There is a twinge of frustration at not being able to actually
            perform the Google query on the screen. My frustration at not being
            able to move forward in this regard mirrors my occasional
            frustration at not being able to go back to &ldquo;simpler
            times&rdquo;.</p>
            
            <p>The screen is a window into the widest of worlds. The queries
            appearing out of nowhere are, in terms of Joseph Campbell&rsquo;s
            monomyth, a &ldquo;call to adventure.&rdquo; The typewriter, on the
            other hand, with its clacking and shuddering, attempts to keep my
            attention on the immediate physical environment. But
            yesterday&rsquo;s technologies ultimately survive <a
                href="http://blag.whit537.org/2008/10/rudy-lehman-typesetter.html">only
                as fetishes</a>. I am using this typewriter for art; my
            children use it as a toy. The safety (from the parents&rsquo;
            perspective) of the typewriter is in marked contrast to the danger
            of the screen. The window to the outside world is also an
            invitation for chaos to enter my home: I modify queries using Luis
            von Ahn&rsquo;s <a
                href="http://www.cs.cmu.edu/~biglou/resources/">Offensive/Profane
                Word List</a>, but that is easily circumvented. This is
            risky.</p>

            <p>In the end, I have nothing but the very slightest influence over
            our hurtling civilization. I try to participate humbly, honestly,
            and optimistically, while building a home and a community that is
            richer than what can be captured on a screen or a sheet of
            paper.</p>


            <h2>Technology</h2>

            <p>This project is also about improving myself as a programmer. The
            max-priority queue of search queries (with the yellow border at
            right) is <a href="db/return.c">implemented in C using a heap</a>,
            <a href="db/test.py">with tests</a>, using a simple binary file
            format for persistence. Queries are prioritized first by number of
            votes, and then by time entered. A text-based web API provides
            access to this underlying executable:</p>

            <table>
                <tr>
                    <td><a href="deadline.txt">Deadline</a></td>
                    <td><b>The timestamp for when voting ends</b>
                        <span class="format">Returns 0 if voting is not 
                                open</span></td>
                </tr>
                <tr>
                    <td><a href="future.txt">Future</a></td>
                    <td><b>A list of all pending queries, max last</b>
                        <span class="format"><b>Format:</b> votes, timestamp 
                            (created), query</span></td>
                </tr>
                <tr>
                    <td><a href="next.txt">Next</a></td>
                    <td><b>The next query (moves it to <i>Past</i>)</b>
                        <span class="format"><b>Format:</b> timestamp 
                            (created), query</span></td>
                </tr>
                <tr>
                    <td><a href="past.txt">Past</a></td>
                    <td><b>A list of all queries, oldest first</b>
                        <span class="format"><b>Format:</b> votes, timestamp 
                            (created), timestamp (used), query</span></td>
                </tr>
            </table>

            <p>Please feel free to use this web API to build applications of
            your own. If you let me know about it, I&rsquo;ll put a link here.
            Any other comments or feedback would also be great.</p>


            <h2>Comments</h2>

            <div id="disqus_thread"></div>
            <script type="text/javascript" src="http://disqus.com/forums/whit537/embed.js"></script>
            <noscript><a href="http://disqus.com/forums/whit537/?url=ref">View the discussion thread.</a></noscript>
        
        </div>


        <div id="stream">
            <table id="knobs">
                <tr class="future">
                    <td colspan="2">

                        <div id="entering">
                            <form action="/return/" method="GET">
                                <input name="q" id="q" />
                                <input type="submit" value="Say It!" />
                                <input type="submit" value="Refresh" />
                            </form>

                            <div>Your entry is <span id="nchars">0</span>
                                character<span id="nchars-plural">s</span> 
                                long. (You get 40 total.)</div>

                        </div>

                        <div id="voting">&nbsp;</div>

                    </td>
                </tr>
            </table>
            <table id="load">
            </table>
        </div>


        <script type="text/javascript">
            //<![CDATA[
        (function() {
            var links = document.getElementsByTagName('a');
                var query = '?';
                    for(var i = 0; i < links.length; i++) {
                        if(links[i].href.indexOf('#disqus_thread') >= 0) {
                                query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
                                    }
                                        }
                                            document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/whit537/get_num_replies.js' + query + '"></' + 'script>');
                                                })();
//]]>
</script>
<script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
        </script>
        <script type="text/javascript">
            try {
                var pageTracker = _gat._getTracker("UA-247427-30");
                pageTracker._trackPageview();
                } catch(err) {}</script> 
</body>
</html>
